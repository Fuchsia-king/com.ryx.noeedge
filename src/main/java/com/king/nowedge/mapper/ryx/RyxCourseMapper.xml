<?xml version="1.0" encoding="UTF-8" ?>   
<!DOCTYPE mapper   
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"   
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">   
<mapper namespace="com.king.nowedge.mapper.ryx.RyxCourseMapper">  

    
    
    <sql id="select">
		
		c.id,
	    c.category,
	    c.title,
	    c.price,
	    c.oprice,
	    c.tid,
	    c.cover_id coverId,
	    c.display,
	    c.position,
	    c.difficulty,
	    c.up,
	    c.down,
	    c.hits,
	    c.study_count studyCount,
	    c.rating,
	    c.rating_count ratingCount,
	    c.update_time updateTime,
	    c.create_time createTime,
	    c.iframe_url iframeUrl,
	    c.status,
	    c.source,
	    c.duration,
	    c.district1,
	    c.district2,
	    c.district3,
	    c.image_url imageUrl,
	    c.image,
	    c.vid,
	    c.try_time tryTime,
	    c.avai_day avaiDay,
	    c.related_course relatedCourse,
	    c.flag,
	    c.renqi,
	    c.score,
	    c.cuid,
	    c.tcate,
	    c.contact_man contactMan,
	    c.address,
	    c.phone,
	    c.reason,
	    c.sort,
	    c.mssort,
	    c.tstart,
	    c.tend,
	    c.url,
	    c.tcreate,
	    c.tmodified,
	    c.creater,
	    c.twoma,
	    c.ideleted,
	    c.subcate,
	    c.descr,
	    c.location,
	    c.obj_type objType,
	    c.put_address putAddress,
	    c.get_http getHttp,
	    c.get_hls getHls,
	    c.get_rtmp getRtmp,	
	    c.inew,
	    c.itop,
	    (c.study_count + c.id%40 + 20) applyCount	    
	    
	</sql>
	
	
	<sql id="select_online">		
		c.id,
	    c.title,
	    c.price,
	    c.oprice,	    
	    c.hits,
	    c.image_url imageUrl,
	    c.image,
	    c.iframe_url iframeUrl,
	    c.get_hls getHls,
	    descr,
	    district2,
	    category,
	    update_time updateTime
	</sql>
	
	
	
	<sql id="select1">
		
		c.id,
	    c.category,
	    c.title,
	    c.price,
	    c.oprice,
	    c.tid,
	    c.cuid,
	    c.tcate,
	    c.cover_id coverId,
	    c.display,
	    c.position,
	    c.difficulty,
	    c.up,
	    c.down,
	    c.hits,
	    c.study_count studyCount,
	    c.rating,
	    c.rating_count ratingCount,
	    c.update_time updateTime,
	    c.create_time createTime,
	    c.status,
	    c.source,
	    c.duration,
	    c.district1,
	    c.district2,
	    c.district3,
	    c.image_url imageUrl,
	    c.image,
	    c.vid,
	    c.try_time tryTime,
	    c.avai_day avaiDay,
	    c.related_course relatedCourse,
	    c.flag,
	    c.renqi,
	    c.score,
	    c.contact_man contactMan,
	    c.address,
	    c.phone,
	    c.reason,
	    c.sort,
	    c.mssort,
	    c.tstart,
	    c.tend,
	    c.url,
	    c.creater,
	    c.twoma,
	    c.ideleted,
	    c.tcreate,
	    c.subcate,
	    c.tmodified,
	    c.descr,
	    c.location,
	    c.obj_type objType,
	    c.put_address putAddress,
	    c.get_http getHttp,
	    c.get_hls getHls,
	    c.get_rtmp getRtmp,
	    c.iframe_url iframeUrl,
	    d.limit_time limitTime,	
	    c.inew,
	    c.itop,
	    (d.limit_time  - UNIX_TIMESTAMP(now()))/60/60/24 leftDays
	    
	</sql>
	
	<sql id="select2">
		
		c.id,
	    c.category,
	    c.title,
	    c.price,
	    c.oprice,
	    c.tid,
	    c.cover_id coverId,
	    c.content,
	    c.display,
	    c.position,
	    c.difficulty,
	    c.cuid,
	    c.tcate,
	    c.up,
	    c.down,
	    c.hits,
	    c.study_count studyCount,
	    c.rating,
	    c.rating_count ratingCount,
	    c.update_time updateTime,
	    c.create_time createTime,
	    c.status,
	    c.location,
	    c.source,
	    c.duration,
	    c.district1,
	    c.district2,
	    c.district3,
	    c.image_url imageUrl,
	    c.image,
	    c.vid,
	    c.try_time tryTime,
	    c.avai_day avaiDay,
	    c.related_course relatedCourse,
	    c.flag,
	    c.renqi,
	    c.score,
	    c.contact_man contactMan,
	    c.address,
	    c.phone,
	    c.reason,
	    c.sort,
	    c.mssort,
	    c.tstart,
	    c.tend,
	    c.url,
	    c.tcreate,	
	    c.inew,
	    c.itop,
	    c.tmodified,
	    c.creater,
	    c.twoma,
	    c.ideleted,
	    c.descr,
	    c.subcate,
	    c.obj_type objType,
	    c.put_address putAddress,
	    c.get_http getHttp,
	    c.get_hls getHls,
	    c.get_rtmp getRtmp,	
	    c.iframe_url iframeUrl,
	    (c.study_count + c.id%40 + 20) applyCount
	    
	</sql>
	
	
	<sql id="select3">
		
		c.id,
	    c.category,
	    c.title,
	    c.price,
	    c.oprice,
	    c.tid,
	    c.cuid,
	    c.tcate,
	    c.cover_id coverId,
	    c.display,
	    c.position,
	    c.difficulty,
	    c.up,
	    c.down,
	    c.hits,
	    c.study_count studyCount,
	    c.rating,
	    c.rating_count ratingCount,
	    c.update_time updateTime,
	    c.create_time createTime,
	    c.status,
	    c.source,
	    c.duration,
	    c.district1,
	    c.district2,
	    c.district3,
	    c.image_url imageUrl,
	    c.image,
	    c.vid,
	    c.try_time tryTime,
	    c.avai_day avaiDay,
	    c.related_course relatedCourse,
	    c.flag,	
	    c.inew,
	    c.itop,
	    c.renqi,
	    c.score,
	    c.contact_man contactMan,
	    c.address,
	    c.phone,
	    c.reason,
	    c.sort,
	    c.mssort,
	    c.tstart,
	    c.tend,
	    c.url,
	    c.creater,
	    c.twoma,
	    c.ideleted,
	    c.tcreate,
	    c.subcate,
	    c.tmodified,
	    c.descr,
	    c.location,
	    c.obj_type objType,
	    c.put_address putAddress,
	    c.get_http getHttp,
	    c.get_hls getHls,
	    c.get_rtmp getRtmp,
	    c.iframe_url iframeUrl,
	    t.limi limitTime,
	    t.status limitStatus	    
	    	    
	</sql>
	
	
	
	<sql id="select_offline">		
		id,
	    title,
	    price,
	    oprice,
	    tid,
	    cuid,
	    coverId,
	    display,
	    location,
	    district2,
	    imageUrl,
	    image,	  
	    tstart,
	    tend,
	    hits,
	    vid   
	</sql>
	
	<sql id="select_video">		
		c.id,
	    c.title,
	    c.price,
	    c.oprice,
	    c.tid,
	    c.cuid,
	    c.cover_id coverId,
	    c.display,
	    c.location,
	    c.district2,
	    c.image_url imageUrl,
	    c.image,	  
	    c.tstart,
	    c.hits,
	    c.tend,
	    c.vid
	</sql>

	<sql id="where">
	
	    <where>
	    
	    	<if test="id != null">
				<![CDATA[ and c.id = #{id} ]]>
			</if>
	    	
	    	
			<if test="category != null">
				<![CDATA[ and c.category = #{category} ]]>
			</if>
			
			<if test="display != null">
				<![CDATA[ and c.display = #{display} ]]>
			</if>
			
			<if test="vid != null">
				<![CDATA[ and c.vid <> '' ]]>
			</if>
			
			<if test="status != null">
				<![CDATA[ and c.status = #{status} ]]>
			</if>
			
			<if test="title != null and title !='' ">
				<![CDATA[and title like concat('%', #{title}, '%')  ]]>			
			</if>
			
			<if test="tid != null">
				<![CDATA[ and c.tid = #{tid} ]]>
			</if>
			
			<if test="cuid != null">
				<![CDATA[ and c.cuid = #{cuid} ]]>
			</if>
			
			<if test="subcate != null">
				<![CDATA[ and c.subcate = #{subcate} ]]>
			</if>
			
			<if test="tcate != null">
				<![CDATA[ and c.tcate = #{tcate} ]]>
			</if>
			
			<if test="flag != null">
				<![CDATA[ and c.flag = #{flag} ]]>
			</if>
			
			<if test="sprice != null">
				<![CDATA[ and c.price > #{sprice} ]]>
			</if>
			
			<if test="eprice != null">
				<![CDATA[ and c.price <= #{eprice} ]]>
			</if>		
			
			<if test="ttstart != null">
				<![CDATA[ and c.tstart >= #{ttstart} ]]>
			</if>
			
			<if test="etstart != null">
				<![CDATA[ and c.tstart < #{etstart} ]]>
			</if>
			
			<if test="ttend != null">
				<![CDATA[ and c.tend >= #{ttend} ]]>
			</if>
			
			<if test="etend != null">
				<![CDATA[ and c.tend < #{etend} ]]>
			</if>
			
			<if test="ustart != null">
				<![CDATA[ and c.update_time >= #{ustart} ]]>
			</if>
			
			<if test="uend != null">
				<![CDATA[ and c.update_time < #{uend} ]]>
			</if>
			
			<if test="difficulty != null">
				<![CDATA[ and c.difficulty = #{difficulty} ]]>
			</if>
			
			<if test="district2 != null and '' != district2 ">
				<![CDATA[ and c.district2 = #{district2} ]]>
			</if>
			
			<if test="keyword != null and keyword !=''">
				<![CDATA[ and (title like '%${keyword}%' ) ]]>
			</if>
			
			<if test="url != null and url !=''">
				<![CDATA[ and c.url is not null ]]>
			</if>
			
			<if test="objType != null">
				<![CDATA[ and c.obj_type = #{objType} ]]>
			</if>
			
			<if test="ideleted != null">
				<![CDATA[ and c.ideleted = #{ideleted} ]]>
			</if>
			
			<if test="flags != null and flags.size()>0" >
	        	and c.flag in
		        <foreach item="flag" index="index" collection="flags" open="(" separator="," close=")">  
				 	#{status}  
				</foreach>
			</if>			
			
			<if test="categorys != null and categorys.size()>0" >
	        	and c.category in
		        <foreach item="category" index="index" collection="categorys" open="(" separator="," close=")">  
				 	#{category} 
				</foreach>
			</if>
			
		</where>
	</sql>
	
	
	
	<sql id="where_living">
	
	    <where>
	    
	    	<if test="id != null">
				<![CDATA[ and c.id = #{id} ]]>
			</if>
	    	
	    	
			<if test="category != null">
				<![CDATA[ and c.category = #{category} ]]>
			</if>
			
			<if test="display != null">
				<![CDATA[ and c.display = #{display} ]]>
			</if>
			
			<if test="status != null">
				<![CDATA[ and c.status = #{status} ]]>
			</if>
			
			<if test="title != null and title !='' ">
				<![CDATA[and title like concat('%', #{title}, '%')  ]]>			
			</if>
			
			<if test="tid != null">
				<![CDATA[ and c.tid = #{tid} ]]>
			</if>
			
			<if test="cuid != null">
				<![CDATA[ and c.cuid = #{cuid} ]]>
			</if>
			
			<if test="subcate != null">
				<![CDATA[ and c.subcate = #{subcate} ]]>
			</if>
			
			<if test="tcate != null">
				<![CDATA[ and c.tcate = #{tcate} ]]>
			</if>
			
			<if test="flag != null">
				<![CDATA[ and c.flag = #{flag} ]]>
			</if>
			
			<if test="sprice != null">
				<![CDATA[ and c.price > #{sprice} ]]>
			</if>
			
			<if test="eprice != null">
				<![CDATA[ and c.price <= #{eprice} ]]>
			</if>		
			
			
			<if test="etstart != null">
				<![CDATA[ and c.tstart < #{etstart} ]]>
			</if>
			
			<if test="ttend != null">
				<![CDATA[ and c.tend >= #{ttend} ]]>
			</if>
			
			
			
			<if test="ustart != null">
				<![CDATA[ and c.update_time >= #{ustart} ]]>
			</if>
			
			<if test="uend != null">
				<![CDATA[ and c.update_time < #{uend} ]]>
			</if>
			
			<if test="difficulty != null">
				<![CDATA[ and c.difficulty = #{difficulty} ]]>
			</if>
			
			<if test="district2 != null and '' != district2 ">
				<![CDATA[ and c.district2 = #{district2} ]]>
			</if>
			
			<if test="keyword != null and keyword !=''">
				<![CDATA[ and (title like '%${keyword}%' ) ]]>
			</if>
			
			<if test="objType != null">
				<![CDATA[ and c.obj_type = #{objType} ]]>
			</if>
			
			<if test="ideleted != null">
				<![CDATA[ and c.ideleted = #{ideleted} ]]>
			</if>
			
			<if test="flags != null and flags.size()>0" >
	        	and c.flag in
		        <foreach item="flag" index="index" collection="flags" open="(" separator="," close=")">  
				 	#{status}  
				</foreach>
			</if>			
			
			<if test="categorys != null and categorys.size()>0" >
	        	and c.category in
		        <foreach item="category" index="index" collection="categorys" open="(" separator="," close=")">  
				 	#{category} 
				</foreach>
			</if>
			
		</where>
	</sql>
	
	
	
	<sql id="where_before_living">
	
	    <where>
	    
	    	<if test="id != null">
				<![CDATA[ and c.id = #{id} ]]>
			</if>
	    	
	    	
			<if test="category != null">
				<![CDATA[ and c.category = #{category} ]]>
			</if>
			
			<if test="display != null">
				<![CDATA[ and c.display = #{display} ]]>
			</if>
			
			<if test="status != null">
				<![CDATA[ and c.status = #{status} ]]>
			</if>
			
			<if test="title != null and title !='' ">
				<![CDATA[and title like concat('%', #{title}, '%')  ]]>			
			</if>
			
			<if test="tid != null">
				<![CDATA[ and c.tid = #{tid} ]]>
			</if>
			
			<if test="cuid != null">
				<![CDATA[ and c.cuid = #{cuid} ]]>
			</if>
			
			<if test="subcate != null">
				<![CDATA[ and c.subcate = #{subcate} ]]>
			</if>
			
			<if test="tcate != null">
				<![CDATA[ and c.tcate = #{tcate} ]]>
			</if>
			
			<if test="flag != null">
				<![CDATA[ and c.flag = #{flag} ]]>
			</if>
			
			<if test="sprice != null">
				<![CDATA[ and c.price > #{sprice} ]]>
			</if>
			
			<if test="eprice != null">
				<![CDATA[ and c.price <= #{eprice} ]]>
			</if>				
			
			<if test="ttstart != null">
				<![CDATA[ and c.tstart >= #{ttstart} ]]>
			</if>			
			
			<if test="ustart != null">
				<![CDATA[ and c.update_time >= #{ustart} ]]>
			</if>
			
			<if test="uend != null">
				<![CDATA[ and c.update_time < #{uend} ]]>
			</if>
			
			<if test="difficulty != null">
				<![CDATA[ and c.difficulty = #{difficulty} ]]>
			</if>
			
			<if test="district2 != null and '' != district2 ">
				<![CDATA[ and c.district2 = #{district2} ]]>
			</if>
			
			<if test="keyword != null and keyword !=''">
				<![CDATA[ and (title like '%${keyword}%' ) ]]>
			</if>
			
			<if test="objType != null">
				<![CDATA[ and c.obj_type = #{objType} ]]>
			</if>
			
			<if test="ideleted != null">
				<![CDATA[ and c.ideleted = #{ideleted} ]]>
			</if>
			
			<if test="flags != null and flags.size()>0" >
	        	and c.flag in
		        <foreach item="flag" index="index" collection="flags" open="(" separator="," close=")">  
				 	#{status}  
				</foreach>
			</if>			
			
			<if test="categorys != null and categorys.size()>0" >
	        	and c.category in
		        <foreach item="category" index="index" collection="categorys" open="(" separator="," close=")">  
				 	#{category} 
				</foreach>
			</if>
			
		</where>
	</sql>
	
	
	<sql id="where_after_living">
	
	    <where>
	    
	    	<if test="id != null">
				<![CDATA[ and c.id = #{id} ]]>
			</if>
	    	
	    	
			<if test="category != null">
				<![CDATA[ and c.category = #{category} ]]>
			</if>
			
			<if test="display != null">
				<![CDATA[ and c.display = #{display} ]]>
			</if>
			
			<if test="status != null">
				<![CDATA[ and c.status = #{status} ]]>
			</if>
			
			<if test="title != null and title !='' ">
				<![CDATA[and title like concat('%', #{title}, '%')  ]]>			
			</if>
			
			<if test="tid != null">
				<![CDATA[ and c.tid = #{tid} ]]>
			</if>
			
			<if test="cuid != null">
				<![CDATA[ and c.cuid = #{cuid} ]]>
			</if>
			
			<if test="subcate != null">
				<![CDATA[ and c.subcate = #{subcate} ]]>
			</if>
			
			<if test="tcate != null">
				<![CDATA[ and c.tcate = #{tcate} ]]>
			</if>
			
			<if test="flag != null">
				<![CDATA[ and c.flag = #{flag} ]]>
			</if>
			
			<if test="sprice != null">
				<![CDATA[ and c.price > #{sprice} ]]>
			</if>
			
			<if test="eprice != null">
				<![CDATA[ and c.price <= #{eprice} ]]>
			</if>	
			
			<if test="etend != null">
				<![CDATA[ and c.tend < #{etend} ]]>
			</if>
			
			<if test="ustart != null">
				<![CDATA[ and c.update_time >= #{ustart} ]]>
			</if>
			
			<if test="uend != null">
				<![CDATA[ and c.update_time < #{uend} ]]>
			</if>
			
			<if test="difficulty != null">
				<![CDATA[ and c.difficulty = #{difficulty} ]]>
			</if>
			
			<if test="district2 != null and '' != district2 ">
				<![CDATA[ and c.district2 = #{district2} ]]>
			</if>
			
			<if test="keyword != null and keyword !=''">
				<![CDATA[ and (title like '%${keyword}%' ) ]]>
			</if>
			
			<if test="objType != null">
				<![CDATA[ and c.obj_type = #{objType} ]]>
			</if>
			
			<if test="ideleted != null">
				<![CDATA[ and c.ideleted = #{ideleted} ]]>
			</if>
			
			<if test="flags != null and flags.size()>0" >
	        	and c.flag in
		        <foreach item="flag" index="index" collection="flags" open="(" separator="," close=")">  
				 	#{status}  
				</foreach>
			</if>			
			
			<if test="categorys != null and categorys.size()>0" >
	        	and c.category in
		        <foreach item="category" index="index" collection="categorys" open="(" separator="," close=")">  
				 	#{category} 
				</foreach>
			</if>
			
		</where>
	</sql>
	
	<sql id="where1">
	
	    <where>
	    
	    	<if test="id != null">
				<![CDATA[ and c.id = #{id} ]]>
			</if>
	    	
			<if test="category != null">
				<![CDATA[ and c.category = #{category} ]]>
			</if>
			
			<if test="display != null">
				<![CDATA[ and c.display = #{display} ]]>
			</if>
			
			<if test="status != null">
				<![CDATA[ and c.status = #{status} ]]>
			</if>
			
			<if test="title != null and title !='' ">
				<![CDATA[and title like concat('%', #{title}, '%')  ]]>			
			</if>
			
			<if test="tid != null">
				<![CDATA[ and c.tid = #{tid} ]]>
			</if>
			
			<if test="cuid != null">
				<![CDATA[ and c.cuid = #{cuid} ]]>
			</if>
			
			<if test="subcate != null">
				<![CDATA[ and c.subcate = #{subcate} ]]>
			</if>
			
			<if test="tcate != null">
				<![CDATA[ and c.tcate = #{tcate} ]]>
			</if>
			
			<if test="flag != null">
				<![CDATA[ and c.flag = #{flag} ]]>
			</if>
			
			<if test="sprice != null">
				<![CDATA[ and c.price > #{sprice} ]]>
			</if>
			
			<if test="eprice != null">
				<![CDATA[ and c.price <= #{eprice} ]]>
			</if>		
			
			<if test="ttstart != null">
				<![CDATA[ and c.tstart >= #{ttstart} ]]>
			</if>			
			<if test="etstart != null">
				<![CDATA[ and c.tstart <= #{etstart} ]]>
			</if>
			
			<if test="ttend != null">
				<![CDATA[ and c.tend >= #{ttend} ]]>
			</if>
			
			<if test="ustart != null">
				<![CDATA[ and c.update_time >= #{ustart} ]]>
			</if>
			
			<if test="uend != null">
				<![CDATA[ and c.update_time < #{uend} ]]>
			</if>
			
			<if test="difficulty != null">
				<![CDATA[ and c.difficulty = #{difficulty} ]]>
			</if>
			
			<if test="district2 != null and '' != district2 ">
				<![CDATA[ and c.district2 = #{district2} ]]>
			</if>
			
			<if test="keyword != null and keyword !=''">
				<![CDATA[ and (title like '%${keyword}%' ) ]]>
			</if>
			
			<if test="objType != null">
				<![CDATA[ and c.obj_type = #{objType} ]]>
			</if>
			
			<if test="ideleted != null">
				<![CDATA[ and c.ideleted = #{ideleted} ]]>
			</if>
			
			<if test="flags != null and flags.size()>0" >
	        	and c.flag in
		        <foreach item="flag" index="index" collection="flags" open="(" separator="," close=")">  
				 	#{status}  
				</foreach>
			</if>
			
		</where>
	</sql>
	
	<sql id="where2">
	
	    <where>
	    
	    	<if test="id != null">
				<![CDATA[ and c.id = #{id} ]]>
			</if>
	    	
	    	
			<if test="category != null">
				<![CDATA[ and c.category = #{category} ]]>
			</if>
			
			<if test="display != null">
				<![CDATA[ and c.display = #{display} ]]>
			</if>
			
			<if test="status != null">
				<![CDATA[ and c.status = #{status} ]]>
			</if>
			
			<if test="title != null and title !='' ">
				<![CDATA[and title like concat('%', #{title}, '%')  ]]>			
			</if>
			
			<if test="tid != null">
				<![CDATA[ and c.tid = #{tid} ]]>
			</if>
			
			<if test="cuid != null">
				<![CDATA[ and c.cuid = #{cuid} ]]>
			</if>
			
			<if test="subcate != null">
				<![CDATA[ and c.subcate = #{subcate} ]]>
			</if>
			
			<if test="tcate != null">
				<![CDATA[ and c.tcate = #{tcate} ]]>
			</if>
			
			<if test="flag != null">
				<![CDATA[ and c.flag = #{flag} ]]>
			</if>
			
			<if test="sprice != null">
				<![CDATA[ and c.price > #{sprice} ]]>
			</if>
			
			<if test="eprice != null">
				<![CDATA[ and c.price <= #{eprice} ]]>
			</if>		
		
			
			<if test="ttstart != null">
				<![CDATA[ and c.tstart < #{ttstart} ]]>
			</if>
		
			<if test="etstart != null">
				<![CDATA[ and c.tstart > #{etstart} ]]>
			</if>
			
			<if test="ttend != null">
				<![CDATA[ and c.tend < #{ttend} ]]>
			</if>
			
			<if test="ustart != null">
				<![CDATA[ and c.update_time >= #{ustart} ]]>
			</if>
			
			<if test="uend != null">
				<![CDATA[ and c.update_time < #{uend} ]]>
			</if>
			
			<if test="difficulty != null">
				<![CDATA[ and c.difficulty = #{difficulty} ]]>
			</if>
			
			<if test="district2 != null and '' != district2 ">
				<![CDATA[ and c.district2 = #{district2} ]]>
			</if>
			
			<if test="keyword != null and keyword !=''">
				<![CDATA[ and (title like '%${keyword}%' ) ]]>
			</if>
			
			<if test="objType != null">
				<![CDATA[ and c.obj_type = #{objType} ]]>
			</if>
			
			<if test="ideleted != null">
				<![CDATA[ and c.ideleted = #{ideleted} ]]>
			</if>
			
			<if test="flags != null and flags.size()>0" >
	        	and c.flag in
		        <foreach item="flag" index="index" collection="flags" open="(" separator="," close=")">  
				 	#{status}  
				</foreach>
			</if>
			
		</where>
	</sql>
	
	
	
	
	
	
	
	
	<sql id="orderby">	
		<choose>			
			<when test="orderBy == 'hits' or orderBy == 'tstart' ">
				order by ${orderBy}	
				<if test="sooort != null and sooort !=''">
					${sooort}
				</if>	
			</when>	
			<when test="orderBy != null and orderBy !='' and orderBy != 'hits'">
				order by c.itop desc,c.inew desc,${orderBy}	
				<if test="sooort != null and sooort !=''">
					${sooort}
				</if>	
			</when>	
			<otherwise>
				order by c.itop desc,c.inew desc,c.sort desc
			</otherwise>
		</choose>
		
		<if test="pageSize != null">
			limit ${startRow}, ${pageSize}
		</if>	
		
	</sql>
   
    <insert id="create" parameterType="RyxCourseDTO">   
       insert into ryx_course(
       		
		    category,
		    title,
		    price,
		    oprice,
		    tid,
		    cover_id,
		    content,
		    display,
		    position,
		    difficulty,
		    up,
		    down,
		    hits,
		    study_count,
		    rating,
		    rating_count,
		    update_time,
		    create_time,
		    status,
		    source,
		    duration,
		    district1,
		    district2,
		    district3,
		    image_url,
		    vid,
		    try_time,
		    avai_day,
		    related_course,
		    flag,
		    renqi,
		    contact_man,
		    address,
		    phone,
		    reason,
		    sort,
		    mssort,
		    url,
		    tstart,
		    tend,
		    put_address,
		   get_http,
		   get_hls,
		   get_rtmp,
		   iframe_url,
		   image,
		   creater,
		   twoma,
		   obj_type,
		   score,
		   descr,
		   location,
		   tcate,
		   cuid,
		   subcate
		    
       ) 
       values
       (
       
      		#{category},
		    #{title},
		    #{price},
		    #{oprice},
		    #{tid},
		    #{coverId},
		    #{content},
		    #{display},
		    #{position},
		    #{difficulty},
		    #{up},
		    #{down},
		    #{hits},
		    #{studyCount},
		    #{rating},
		    #{ratingCount},
		    UNIX_TIMESTAMP(now()),
		    UNIX_TIMESTAMP(now()),
		    #{status},
		    #{source},
		    #{duration},
		    #{district1},
		    #{district2},
		    #{district3},
		    #{imageUrl},
		    #{vid},
		    #{tryTime},
		    #{avaiDay},
		    #{relatedCourse},
		    #{flag},
		    #{renqi},
		    #{contactMan},
		    #{address},
		    #{phone},
		    #{reason},
		    #{sort},
		    #{mssort},
		    #{url},
		    #{tstart},
		    #{tend},
		    #{putAddress},
		    #{getHttp},
		    #{getHls},
		    #{getRtmp},
		    #{iframeUrl},
		    #{image},
		    #{creater},
		    #{twoma},
		    #{objType},
		    #{score},
		    #{descr},
		    #{location}	,
		    #{tcate},
		   	#{cuid},
		   	#{subcate}	    
		    
       ) 
       
       <selectKey keyProperty="id" resultType="java.lang.Long" order="AFTER">
			select LAST_INSERT_ID() 
	   </selectKey>
    </insert>
    
    <select id="query" resultType="RyxCourseDTO" parameterType="RyxCourseQuery">         
        select         
        <include refid="select"/>        
        from ryx_course c        
        <include refid="where"/>		
		<include refid="orderby"/>		
    </select>
    
    
    <select id="queryOnline" resultType="RyxSmallCourseDTO" parameterType="RyxCourseQuery">         
        select         
        <include refid="select_online"/>        
        from ryx_course c        
        <include refid="where"/>		
		<include refid="orderby"/>		
    </select>
    
    
   <select id="queryVideo" resultType="RyxCourseDTO" parameterType="RyxCourseQuery">      
     	select <include refid="select_video"/>
		from ryx_course c        
        <include refid="where"/>		
		<include refid="orderby"/>
    </select>
    
    <select id="queryMyVideo" resultType="RyxCourseDTO" parameterType="RyxCourseQuery">      
     	select <include refid="select_video"/> 
     	from ryx_course c        
        join ryx_apply a
        on c.id = a.oid
        <include refid="where"/> and  a.user_id = #{userId} and a.status in(2,3,4,5)  		
		<include refid="orderby"/>
    </select>
    
    
     <select id="countQueryVideo" resultType="java.lang.Integer" parameterType="RyxCourseQuery">      
     	select count(1) from ryx_course c        
        <include refid="where"/>	
    </select>
    
     <select id="countQueryMyVideo" resultType="java.lang.Integer" parameterType="RyxCourseQuery">      
     	select count(1) from  ryx_apply where user_id = #{userId} and otype = #{objType}	
    </select>
    
   <select id="defaultQuery" resultType="RyxCourseDTO" parameterType="RyxCourseQuery">      
     	select <include refid="select_offline"/> from (      
	        select  <include refid="select"/> from ryx_course c  <include refid="where1"/>	        
	        <if test="etstart == null">
		        union
		        select  <include refid="select"/> from ryx_course c  <include refid="where2"/>
	        </if>
        ) c	
		<if test="pageSize != null">
			limit ${startRow}, ${pageSize}
		</if>		        
    </select>
    
    <select id="countDefaultQuery" resultType="java.lang.Integer" parameterType="RyxCourseQuery">   
        select count(1) from (      
	        select id from ryx_course c  <include refid="where1"/> 
	        <if test="etstart == null">	
		        union 
		        select id from ryx_course c  <include refid="where2"/> 
	        </if>
        )a
    </select>
     
    <select id="queryAll" resultType="RyxCourseDTO">         
        select code,name from ryx_course where ideleted = 0 order by name		
    </select>
    
    <select id="countQuery" resultType="java.lang.Integer" parameterType="RyxCourseQuery">   
        select count(1) from ryx_course c
        <include refid="where"/>
    </select>
    
     <select id="countHits" resultType="java.lang.Integer" parameterType="RyxCourseQuery">   
        select sum(hits) from ryx_course c
        <include refid="where"/>
    </select>
    
    <select id="getCourseById" resultType="RyxCourseDTO" parameterType="java.lang.Long">   
        select 
        <include refid="select2"/>
        from ryx_course c 
        where id = #{id}  limit 1;
    </select>    
    
    
    <select id="getCoursePriceById" resultType="java.lang.Double" parameterType="java.lang.Long">   
        select price from ryx_course where id = #{id} limit 1; 
    </select>    
    
    
    
     <select id="getCourseByVId" resultType="RyxCourseDTO" parameterType="java.lang.String">   
        select 
        <include refid="select2"/>
        from ryx_course c 
        where vid = #{vid} 
    </select>  
    
    <select id="getByIds" resultType="RyxCourseDTO" parameterType="java.lang.String">   
        select 
        <include refid="select"/>
        from ryx_course c 
        where id in (#{ids}) 
    </select> 
   
   
   	<update id="updateCourseStudyCount" parameterType="java.lang.Long">
    	 update ryx_course set study_count=study_count+1 where id=#{id}
    </update>
	
	<update id="updateCourseViewCount" parameterType="java.lang.Long">
    	 update ryx_course set hits=hits+1 where id=#{id}
    </update>
    
     <select id="getCourseCountByTeacherId" resultType="java.lang.Integer" parameterType="java.lang.Integer">   
         select count(1) from ryx_course c where tid = #{tid}
    </select>
     <select id="getCourseByTeacherId" resultType="RyxCourseDTO" parameterType="RyxCourseQuery">   
        select * from ryx_course c where tid = #{tid} and obj_type=18 order by tstart
         
        <!--  select			
		<include refid="select"/>
		from ryx_course c where tid = #{tid}       
        <include refid="orderby"/> -->
    </select>
   
   
   	<select id="getMyOfflineCourse" resultType="RyxCourseDTO" parameterType="RyxCourseQuery">         
        select			
		<include refid="select"/>
		from ryx_order t 
        join ryx_order_detail d on t.id=d.order_id 
        join ryx_course c on d.obj_id=c.id 
        where t.status = 2 and t.order_type =1  and c.flag=1 and t.order_uid=#{userId}        
        <include refid="orderby"/>
        
    </select>
    
    
    <select id="getMyOfflineCount" resultType="java.lang.Integer" parameterType="RyxCourseQuery">         
        select	count(1)  from ryx_order t 
        join ryx_order_detail d on t.id=d.order_id 
        join ryx_course c on d.obj_id=c.id 
        where t.status = 2 and t.order_type =1  and c.flag=1 and t.order_uid=#{userId}
        limit 1;
    </select>
   

	<select id="getMyExpiredCourse" resultType="RyxCourseDTO" parameterType="RyxCourseQuery">         
        select 
		<include refid="select"/>
		from ryx_order t 
        join ryx_order_detail d on t.id=d.order_id 
        join ryx_course c on d.obj_id=c.id 
        where t.status = 2 and t.order_type =1 and c.obj_type = 1 and t.order_uid=#{userId} 
        and <![CDATA[ d.limit_time < #{tnow} ]]>
        <include refid="orderby"/>        
    </select>
    
    <select id="getMyExpiredCourse1" resultType="RyxCourseDTO" parameterType="RyxCourseQuery">         
        select 
		<include refid="select"/>
		from ryx_object_limit t
        join ryx_course c on t.oid=c.id and t.otype = c.obj_type
        where c.obj_type = #{objType} and t.user_id=#{userId} 
        and <![CDATA[ t.limi < #{tnow} ]]>
        <include refid="orderby"/>        
    </select>
    
    
    
   
    
    <select id="getMyExpiredCount1" resultType="java.lang.Integer" parameterType="RyxCourseQuery">         
        select count(1) from 
        ryx_object_limit t
        join ryx_course c on t.oid=c.id and t.otype = c.obj_type
        where c.obj_type = #{objType} and t.user_id=#{userId} 
        and <![CDATA[ t.limi < #{tnow} ]]>
        limit 1;      
    </select>
    
    <select id="getMyExpiredCount" resultType="java.lang.Integer" parameterType="RyxCourseQuery">         
        select count(1) from ryx_order t 
        join ryx_order_detail d on t.id=d.order_id 
        join ryx_course c on d.obj_id=c.id 
        where t.status = 2 and t.order_type =1 and c.obj_type = 1 and t.order_uid=#{userId} 
        and <![CDATA[ d.limit_time < #{tnow} ]]>
        limit 1;      
    </select>
    
    
    
    <select id="getMyCourse" resultType="RyxCourseDTO" parameterType="RyxCourseQuery">         
        select 
		<include refid="select3"/>
		from ryx_object_limit t
        join ryx_course c on t.oid=c.id and t.otype = c.obj_type
        where c.obj_type = #{objType} and t.user_id=#{userId}
        <include refid="orderby"/>        
    </select>
    
    <select id="getMyCourseCount" resultType="java.lang.Integer" parameterType="RyxCourseQuery">         
        select count(1) from 
        ryx_object_limit t
        join ryx_course c on t.oid=c.id and t.otype = c.obj_type
        where c.obj_type = #{objType} and t.user_id=#{userId} 
        limit 1;      
    </select>
    
    
    <select id="getMyFollowCourse" resultType="RyxCourseDTO" parameterType="RyxCourseQuery">         
        select 
		<include refid="select"/>
		from ryx_user_follow_course t
        join ryx_course c on t.course_id=c.id 
      	where t.user_id = #{userId} 
     	<if test="objType != null">
			<![CDATA[ and t.otype = #{objType} ]]>
		</if> 
		<if test="category != null">
			<![CDATA[ and c.category = #{category} ]]>
		</if> 
		
		<if test="objTypes != null and objTypes.size()>0" >
        	and t.otype in
	        <foreach item="objType" index="index" collection="objTypes" open="(" separator="," close=")">  
			 	#{objType}  
			</foreach>
		</if>
		
		
        <include refid="orderby"/>
        
    </select>


	<select id="getMyFollowCourseCount" resultType="java.lang.Integer" parameterType="RyxCourseQuery">         
        select count(1)
		from ryx_user_follow_course t
        join ryx_course c on t.course_id=c.id       
		where t.user_id = #{userId}  
		<if test="objType != null">
			<![CDATA[ and t.otype = #{objType} ]]>
		</if>  
		<if test="category != null">
			<![CDATA[ and c.category = #{category} ]]>
		</if> 
		<if test="objTypes != null and objTypes.size()>0" >
        	and t.otype in
	        <foreach item="objType" index="index" collection="objTypes" open="(" separator="," close=")">  
			 	#{objType}  
			</foreach>
		</if>
		limit 1;        
    </select>

	<select id="getMyUnexpiredCourse" resultType="RyxCourseDTO" parameterType="RyxCourseQuery">         
        select
        <include refid="select1"/> 
        from ryx_order t 
        join ryx_order_detail d on t.id=d.order_id 
        join ryx_course c on d.obj_id=c.id 
        where t.status = 2 and t.order_type = 1  and c.obj_type =1 and t.order_uid=#{userId}
        
        <if test="orderCourseIds != null and orderCourseIds.size()>0" >
        	and c.id in
	        <foreach item="courseId" index="index" collection="orderCourseIds" open="(" separator="," close=")">  
			 	#{courseId}  
			</foreach>
		</if>

        <![CDATA[ and d.limit_time >= #{tnow} ]]>
        
        <if test="id != null">
			<![CDATA[and  c.id = #{id} ]]>
		</if>
		
		<include refid="orderby"/>
		
    </select>
    
    
    <select id="getMyUnexpiredCourse1" resultType="RyxCourseDTO" parameterType="RyxCourseQuery">         
        select
        <include refid="select3"/> 
        from ryx_object_limit t
        join ryx_course c on t.oid = c.id and t.otype = c.obj_type
        where c.obj_type = #{objType} 
        <if test="userId != null">
        	and t.user_id=#{userId}
        </if>
        <if test="tstatus != null">
        	and t.status=#{tstatus}
        </if>
        <if test="category != null">
        	and t.category=#{category}
        </if>
        <if test="orderCourseIds != null and orderCourseIds.size()>0" >
        	and c.id in
	        <foreach item="courseId" index="index" collection="orderCourseIds" open="(" separator="," close=")">  
			 	#{courseId}  
			</foreach>
		</if>
		<if test="tnow != null">
        	<![CDATA[ and t.limi >= #{tnow} ]]>
        </if>        
		<include refid="orderby"/>
		
    </select>
    
    <select id="getMyUnexpiredCourse2" resultType="RyxObjectLimitDTO" parameterType="RyxCourseQuery">         
        select t.moid,t.status from ryx_object_limit t,ryx_course c
        where t.otype = #{objType} 
        and t.moid is not null
        and t.moid = c.id
        <if test="userId != null">
        	and t.user_id=#{userId}
        </if>
        <if test="keyword != null and keyword != '' ">
        	<![CDATA[and c.title like concat('%', #{keyword}, '%')  ]]>
        </if>
        <if test="category != null">
        	and t.category=#{category}
        </if>
        <if test="orderType != null">
        	and t.order_type=#{orderType}
        </if>
        <if test="tstatus != null">
        	and t.status=#{tstatus}
        </if>
		<if test="tnow != null">
        	<![CDATA[ and t.limi >= #{tnow} ]]>
        </if>        
        group by moid,status
		<if test="pageSize != null">
			limit ${startRow}, ${pageSize}
		</if>
    </select>
    
    <select id="getMyExpiredCount2" resultType="java.lang.Integer" parameterType="RyxCourseQuery"> 
        select count(1) from (
        select moid,status from ryx_object_limit t 
        where 
        t.user_id=#{userId}
        <if test="objType != null">
        	and t.otype=#{objType}
        </if>
        <if test="category != null">
        	and t.category=#{category}
        </if>        
        <if test="orderType != null">
        	and t.order_type=#{orderType}
        </if>
        and <![CDATA[ t.limi < #{tnow} ]]> and moid is not null
        group by moid,status ) tmp
        limit 1;   
    </select>
    
    <select id="getMyUnexpiredCount2" resultType="java.lang.Integer" parameterType="RyxCourseQuery"> 
       select count(1) from (
        select t.moid,t.status from ryx_object_limit t ,ryx_course c
        where 
        t.user_id=#{userId} 
        and t.moid is not null
        and t.moid = c.id
        <if test="objType != null">
        	and t.otype=#{objType}
        </if>
        <if test="keyword != null and keyword != '' ">
        	<![CDATA[and c.title like concat('%', #{keyword}, '%')  ]]>
        </if>
        <if test="category != null">
        	and t.category=#{category}
        </if>    
        <if test="orderType != null">
        	and t.order_type=#{orderType}
        </if>  
        <if test="tstatus != null">
        	and t.status=#{tstatus}
        </if>  
        <if test="tnow != null">
        	<![CDATA[ and t.limi >= #{tnow} ]]>
        </if>
        group by moid,status ) tmp
        limit 1;      
    </select>
    
    
    <select id="getMyExpiredCourse2" resultType="RyxObjectLimitDTO" parameterType="RyxCourseQuery">         
        select moid,status from ryx_object_limit t
        where t.otype = #{objType} and moid is not null
        <if test="userId != null">
        	and t.user_id=#{userId}
        </if>
        <if test="category != null">
        	and t.category=#{category}
        </if>
        <if test="orderType != null">
        	and t.order_type=#{orderType}
        </if>
        <if test="tstatus != null">
        	and t.status=#{tstatus}
        </if>
		<if test="tnow != null">
        	<![CDATA[ and t.limi <= #{tnow} ]]>
        </if>        
        group by moid,status
		<if test="pageSize != null">
			limit ${startRow}, ${pageSize}
		</if>		
    </select>
    
    <select id="getMyUnexpiredCount" resultType="java.lang.Integer" parameterType="RyxCourseQuery">         
        select count(1) from ryx_order t 
        join ryx_order_detail d on t.id=d.order_id 
        join ryx_course c on d.obj_id=c.id 
        where t.status = 2 and t.order_type =1  and c.obj_type =1 and t.order_uid=#{userId}
        
        <if test="orderCourseIds != null and orderCourseIds.size()>0" >
        	and c.id in
	        <foreach item="courseId" index="index" collection="orderCourseIds" open="(" separator="," close=")">  
			 	#{courseId}  
			</foreach>
		</if>

        <![CDATA[ and d.limit_time >= #{tnow} ]]>
        
        <if test="id != null">
			<![CDATA[and  c.id = #{id} ]]>
		</if>
		
		limit 1;
		
    </select>
	
	
	 <select id="getMyUnexpiredCount1" resultType="java.lang.Integer" parameterType="RyxCourseQuery">         
        select count(1)
        from ryx_object_limit t
        join ryx_course c on t.oid = c.id and t.otype = c.obj_type
        where c.obj_type = #{objType}
        <if test="userId != null">
        	and t.user_id=#{userId}
        </if>
        <if test="category != null">
        	and t.category=#{category}
        </if>
        <if test="orderType != null">
        	and t.order_type=#{orderType}
        </if>
         <if test="tstatus != null">
        	and t.status=#{tstatus}
        </if>
        <if test="orderCourseIds != null and orderCourseIds.size()>0" >
        	and c.id in
	        <foreach item="courseId" index="index" collection="orderCourseIds" open="(" separator="," close=")">  
			 	#{courseId}  
			</foreach>
		</if>
        <if test="tnow != null">
        	<![CDATA[ and t.limi >= #{tnow} ]]>
        </if> 
		limit 1;
    </select>
    
     <select id="queryCourseWidespread" resultType="RyxCourseDTO" parameterType="RyxCourseQuery">
         
        select         
        <include refid="select"/>        
        from ryx_course c        
        where ((obj_type=1 and flag=21) or obj_type=10 or obj_type=18 ) and ideleted=0 and display=1
		<include refid="orderby"/>		
    </select>
    
    
    <update id="addDownloadCount" parameterType="java.lang.Long">
    	update ryx_course set renqi = renqi + 1 where id = #{id}
    </update>
    
    <update id="update" parameterType="RyxCourseDTO">
    
        update ryx_course
         
        <set>	
					
			<if test="category != null">
				<![CDATA[ category = #{category} ]]>,
			</if>
			
			<if test="image != null">
				<![CDATA[ image = #{image} ]]>,
			</if>
			
			<if test="title != null">
				<![CDATA[ title = #{title} ]]>,
			</if>
			
			<if test="price != null">
				<![CDATA[ price = #{price} ]]>,
			</if>
			
			<if test="oprice != null">
				<![CDATA[ oprice = #{oprice} ]]>,
			</if>
			
			<if test="tid != null">
				<![CDATA[ tid = #{tid} ]]>,
			</if>
			
			<if test="coverId != null">
				<![CDATA[ cover_id = #{coverId} ]]>,
			</if>
			
			<if test="content != null">
				<![CDATA[ content = #{content} ]]>,
			</if>

			<if test="display != null">
				<![CDATA[ display = #{display} ]]>,
			</if>
			
			<if test="position != null">
				<![CDATA[ position = #{position} ]]>,
			</if>
			
			<if test="difficulty != null">
				<![CDATA[ difficulty = #{difficulty} ]]>,
			</if>
			
			<if test="up != null">
				<![CDATA[ up = #{up} ]]>,
			</if>
			
			<if test="down != null">
				<![CDATA[ down = #{down} ]]>,
			</if>
			
			<if test="hits != null and hits != 0">
				<![CDATA[ hits = #{hits} ]]>,
			</if>
			
			<if test="inew != null">
				<![CDATA[ inew = #{inew} ]]>,
			</if>
			
			<if test="itop != null">
				<![CDATA[ itop = #{itop} ]]>,
			</if>
			
			<if test="studyCount != null">
				<![CDATA[ study_count = #{studyCount} ]]>,
			</if>
			
			<if test="objType != null">
				<![CDATA[ obj_type = #{objType} ]]>,
			</if>
			
			<if test="rating != null">
				<![CDATA[ rating = #{rating} ]]>,
			</if>
			
			<if test="ratingCount != null">
				<![CDATA[ rating_count = #{ratingCount} ]]>,
			</if>
		
			
			<if test="createTime != null">
				<![CDATA[ create_time = #{createTime} ]]>,
			</if>
			
			<if test="status != null">
				<![CDATA[ status = #{status} ]]>,
			</if>
			
			<if test="source != null">
				<![CDATA[ source = #{source} ]]>,
			</if>
			
			<if test="duration != null">
				<![CDATA[ duration = #{duration} ]]>,
			</if>
			
			<if test="district1 != null">
				<![CDATA[ district1 = #{district1} ]]>,
			</if>
			
			<if test="district2 != null">
				<![CDATA[ district2 = #{district2} ]]>,
			</if>
			
			<if test="district3 != null">
				<![CDATA[ district3 = #{district3} ]]>,
			</if>
			
			<if test="imageUrl != null">
				<![CDATA[ image_url = #{imageUrl} ]]>,
			</if>
			
			<if test="vid != null">
				<![CDATA[ vid = #{vid} ]]>,
			</if>
			
			<if test="tryTime != null">
				<![CDATA[ try_time = #{tryTime} ]]>,
			</if>
			
			<if test="avaiDay != null">
				<![CDATA[ avai_day = #{avaiDay} ]]>,
			</if>
			
			<if test="relatedCourse != null">
				<![CDATA[ related_course = #{relatedCourse} ]]>,
			</if>
			
			<if test="flag != null">
				<![CDATA[ flag = #{flag} ]]>,
			</if>
			
			<if test="renqi != null">
				<![CDATA[ renqi = #{renqi} ]]>,
			</if>
			
			<if test="contactMan != null">
				<![CDATA[ contact_man = #{contactMan} ]]>,
			</if>			
			
			<if test="address != null">
				<![CDATA[ address = #{address} ]]>,
			</if>
			
			<if test="phone != null">
				<![CDATA[ phone = #{phone} ]]>,
			</if>
			
			<if test="reason != null">
				<![CDATA[ reason = #{reason} ]]>,
			</if>
			
			<if test="sort != null">
				<![CDATA[ sort = #{sort} ]]>,
			</if>
			
			<if test="mssort != null">
				<![CDATA[ mssort = #{mssort} ]]>,
			</if>
			
			<if test="svid != null">
				<![CDATA[ svid = #{svid} ]]>,
			</if>
			
			<if test="tcreate != null">
				<![CDATA[ tcreate = #{tcreate} ]]>,
			</if>
			
			<if test="tmodified != null">
				<![CDATA[ tmodified = #{tmodified} ]]>,
			</if>
			
			<if test="url != null">
				<![CDATA[ url = #{url} ]]>,
			</if>
			
			<if test="tstart != null">
				<![CDATA[ tstart = #{tstart} ]]>,
			</if>
			
			<if test="tend != null">
				<![CDATA[ tend = #{tend} ]]>,
			</if>
			
			<if test="putAddress != null">
				<![CDATA[ put_address = #{putAddress} ]]>,
			</if>
			
			<if test="getHttp != null">
				<![CDATA[ get_http = #{getHttp} ]]>,
			</if>
			
			<if test="getHls != null">
				<![CDATA[ get_hls = #{getHls} ]]>,
			</if>
			
			<if test="getRtmp != null">
				<![CDATA[ get_rtmp = #{getRtmp} ]]>,
			</if>
			
			<if test="iframeUrl != null">
				<![CDATA[ iframe_url = #{iframeUrl} ]]>,
			</if>			
			<if test="ideleted != null">
				<![CDATA[ ideleted = #{ideleted} ]]>,
			</if>
			<if test="descr != null">
				<![CDATA[ descr = #{descr} ]]>,
			</if>
			<if test="location != null">
				<![CDATA[ location = #{location} ]]>,
			</if>
			<if test="subcate != null">
				<![CDATA[ subcate = #{subcate} ]]>,
			</if>
			<if test="tcate != null">
				<![CDATA[ tcate = #{tcate} ]]>,
			</if>
			<if test="twoma != null">
				<![CDATA[ twoma = #{twoma} ]]>,
			</if>
			 <if test="cuid != null">
				<![CDATA[cuid = #{cuid} ]]>,
			 </if>	
			
			 creater = #{creater} 
		 </set>
		 
		 where	id = #{id} 
		 	
    </update>
    
    
     <update id="refresh" parameterType="RyxCourseDTO">
        update ryx_course
        <set>	
		 	update_time = UNIX_TIMESTAMP(now()),
		 	tmodified = now(),
		</set>
		where	id = #{id} 
    </update>
    
    
    <update id="update1" parameterType="RyxCourseDTO">
        update ryx_course
        <set>	
					
			<if test="category != null">
				<![CDATA[ category = #{category} ]]>,
			</if>
			
			<if test="title != null">
				<![CDATA[ title = #{title} ]]>,
			</if>
			
			<if test="price != null">
				<![CDATA[ price = #{price} ]]>,
			</if>
			
			<if test="oprice != null">
				<![CDATA[ oprice = #{oprice} ]]>,
			</if>
			
			<if test="image != null">
				<![CDATA[ image = #{image} ]]>,
			</if>
			
			<if test="tid != null">
				<![CDATA[ tid = #{tid} ]]>,
			</if>
			
			<if test="coverId != null">
				<![CDATA[ cover_id = #{coverId} ]]>,
			</if>
			
			<if test="content != null">
				<![CDATA[ content = #{content} ]]>,
			</if>

			<if test="display != null">
				<![CDATA[ display = #{display} ]]>,
			</if>
			
			<if test="position != null">
				<![CDATA[ position = #{position} ]]>,
			</if>
			
			<if test="difficulty != null">
				<![CDATA[ difficulty = #{difficulty} ]]>,
			</if>
			
			<if test="up != null">
				<![CDATA[ up = #{up} ]]>,
			</if>
			
			<if test="down != null">
				<![CDATA[ down = #{down} ]]>,
			</if>
			
			<if test="hits != null and hits != 0">
				<![CDATA[ hits = #{hits} ]]>,
			</if>
			
			<if test="inew != null">
				<![CDATA[ inew = #{inew} ]]>,
			</if>
			
			<if test="itop != null">
				<![CDATA[ itop = #{itop} ]]>,
			</if>
			
			<if test="studyCount != null">
				<![CDATA[ study_count = #{studyCount} ]]>,
			</if>
			
			<if test="objType != null">
				<![CDATA[ obj_type = #{objType} ]]>,
			</if>
			
			<if test="rating != null">
				<![CDATA[ rating = #{rating} ]]>,
			</if>
			
			<if test="ratingCount != null">
				<![CDATA[ rating_count = #{ratingCount} ]]>,
			</if>
		
			
			<if test="createTime != null">
				<![CDATA[ create_time = #{createTime} ]]>,
			</if>
			
			<if test="status != null">
				<![CDATA[ status = #{status} ]]>,
			</if>
			
			<if test="source != null">
				<![CDATA[ source = #{source} ]]>,
			</if>
			
			<if test="duration != null">
				<![CDATA[ duration = #{duration} ]]>,
			</if>
			
			<if test="district1 != null">
				<![CDATA[ district1 = #{district1} ]]>,
			</if>
			
			<if test="district2 != null">
				<![CDATA[ district2 = #{district2} ]]>,
			</if>
			
			<if test="district3 != null">
				<![CDATA[ district3 = #{district3} ]]>,
			</if>
			
			<if test="imageUrl != null">
				<![CDATA[ image_url = #{imageUrl} ]]>,
			</if>
			
			<if test="vid != null">
				<![CDATA[ vid = #{vid} ]]>,
			</if>
			
			<if test="tryTime != null">
				<![CDATA[ try_time = #{tryTime} ]]>,
			</if>
			
			<if test="avaiDay != null">
				<![CDATA[ avai_day = #{avaiDay} ]]>,
			</if>
			
			<if test="relatedCourse != null">
				<![CDATA[ related_course = #{relatedCourse} ]]>,
			</if>
			
			<if test="flag != null">
				<![CDATA[ flag = #{flag} ]]>,
			</if>
			
			<if test="renqi != null">
				<![CDATA[ renqi = #{renqi} ]]>,
			</if>
			
			<if test="contactMan != null">
				<![CDATA[ contact_man = #{contactMan} ]]>,
			</if>			
			
			<if test="address != null">
				<![CDATA[ address = #{address} ]]>,
			</if>
			
			<if test="phone != null">
				<![CDATA[ phone = #{phone} ]]>,
			</if>
			
			<if test="reason != null">
				<![CDATA[ reason = #{reason} ]]>,
			</if>
			
			<if test="sort != null">
				<![CDATA[ sort = #{sort} ]]>,
			</if>
			
			<if test="mssort != null">
				<![CDATA[ mssort = #{mssort} ]]>,
			</if>
			
			<if test="svid != null">
				<![CDATA[ svid = #{svid} ]]>,
			</if>
			
			<if test="tcreate != null">
				<![CDATA[ tcreate = #{tcreate} ]]>,
			</if>
			
			<if test="tmodified != null">
				<![CDATA[ tmodified = #{tmodified} ]]>,
			</if>
			
			<if test="url != null">
				<![CDATA[ url = #{url} ]]>,
			</if>
			
			<if test="tstart != null">
				<![CDATA[ tstart = #{tstart} ]]>,
			</if>
			
			<if test="tend != null">
				<![CDATA[ tend = #{tend} ]]>,
			</if>
			
			<if test="putAddress != null">
				<![CDATA[ put_address = #{putAddress} ]]>,
			</if>
			
			<if test="getHttp != null">
				<![CDATA[ get_http = #{getHttp} ]]>,
			</if>
			
			<if test="getHls != null">
				<![CDATA[ get_hls = #{getHls} ]]>,
			</if>
			
			<if test="getRtmp != null">
				<![CDATA[ get_rtmp = #{getRtmp} ]]>,
			</if>
			
			<if test="iframeUrl != null">
				<![CDATA[ iframe_url = #{iframeUrl} ]]>,
			</if>			
			<if test="ideleted != null">
				<![CDATA[ ideleted = #{ideleted} ]]>,
			</if>
			<if test="descr != null">
				<![CDATA[ descr = #{descr} ]]>,
			</if>
			<if test="location != null">
				<![CDATA[ location = #{location} ]]>,
			</if>
			<if test="subcate != null">
				<![CDATA[ subcate = #{subcate} ]]>,
			</if>
			<if test="tcate != null">
				<![CDATA[ tcate = #{tcate} ]]>,
			</if>
			<if test="twoma != null">
				<![CDATA[ twoma = #{twoma} ]]>,
			</if>
			 <if test="cuid != null">
				<![CDATA[cuid = #{cuid} ]]>,
			 </if>	
			 creater = #{creater} 
		 </set>
		 
		 where	id = #{id} 
		 	
    </update> 
    
     
    
    <sql id="select_partner">		
		id,
	    title,
	    price,
	    oprice,	    
	    descr,
	    image_url imageUrl,
	    update_time updateTime
	</sql>
    
    <delete id="delete" parameterType="java.lang.String">
    
        update ryx_course         
        set ideleted = 1		 
		where uid = #{uid}
		 	
    </delete> 
    
    <delete id="delete1" parameterType="java.lang.Long">
        delete from ryx_course where id = #{id}
    </delete> 
    
    
    <select id="defaultQuery1" resultType="RyxCourseDTO" parameterType="RyxCourseQuery">      
     	select * from (      
	        select <include refid="select_partner"/> from ryx_course c where obj_type = 1 and flag = 21 and display = 1 and ideleted = 0 and price > 0 
	        union
	        select <include refid="select_partner"/> from ryx_course c where obj_type = 10 and display = 1 and ideleted = 0  and price > 0 
        ) c	
        order by updateTime desc
		<if test="pageSize != null">
			limit ${startRow}, ${pageSize}
		</if>		        
    </select>
    
    
    <select id="countDefaultQuery1" resultType="java.lang.Integer" parameterType="RyxCourseQuery">   
       	select count(1) from (      
	        select <include refid="select_partner"/> from ryx_course c where obj_type = 1 and flag = 21 and display = 1 and ideleted = 0 and price > 0 
	        union
	        select <include refid="select_partner"/> from ryx_course c where obj_type = 10 and display = 1 and ideleted = 0  and price > 0 
        ) c	
    </select>
    
</mapper> 